let e=null;class t{constructor(){this.subs=/* @__PURE__ */new Set}depend(){e&&this.subs.add(e)}notify(){this.subs.forEach(e=>e())}}function n(t){const n=e;e=t;try{t()}finally{e=n}}function r(e){const n=new t;return{_isRef:!0,get value(){return n.depend(),e},set value(t){t!==e&&(e=t,n.notify())},toString:()=>e}}const s=(e,t)=>{try{const n=Object.keys(t),r=n.map(e=>t[e]?._isRef?t[e].value:t[e]);return new Function(...n,`return ${e}`)(...r)}catch{return}},o=(e,t)=>{if(e){if(3===e.nodeType){const r=e.textContent;return void(r.includes("{{")&&n(()=>{e.textContent=r.replace(/{{\s*(.*?)\s*}}/g,(e,n)=>s(n,t))}))}if(1===e.nodeType){if(e.hasAttribute("z-if")){const r=[];let i=e;const c=e.parentNode;if(!c)return;const a=document.createComment("z-if");for(c.insertBefore(a,e);i;){const e=["z-if","z-else-if","z-else"].find(e=>i.hasAttribute(e));if(!e)break;const t=i.getAttribute(e);i.removeAttribute(e),r.push({el:i,exp:t,type:e});const n=i.nextElementSibling;i.remove(),i=n}return void n(()=>{const e=r.find(e=>"z-else"===e.type||s(e.exp,t));r.forEach(n=>{n===e?document.contains(n.el)||(c.insertBefore(n.el,a.nextSibling),n.el._isCompiled||(n.el._isCompiled=!0,o(n.el,t))):document.contains(n.el)&&n.el.remove()})})}if(!e.hasAttribute("z-else-if")&&!e.hasAttribute("z-else")){if(e.hasAttribute("z-for")){const[r,i]=e.getAttribute("z-for").split(" in ").map(e=>e.trim()),c=e.parentNode;if(!c)return;const a=document.createComment("z-for");c.insertBefore(a,e),e.remove(),e.removeAttribute("z-for");let l=[];return void n(()=>{l.forEach(e=>e.remove()),l=[];const n=s(i,t)||[];Array.isArray(n)&&n.forEach((n,s)=>{const i=e.cloneNode(!0);c.insertBefore(i,a),l.push(i);const u={...t,[r]:{value:n,_isRef:!0},index:s};o(i,u)})})}Array.from(e.attributes).forEach(({name:r,value:o})=>{if(r.startsWith("@")||r.startsWith("z-on:")){const n=r.startsWith("@")?r.slice(1):r.slice(5);e.removeAttribute(r),e.addEventListener(n,e=>{const n=t[o];"function"==typeof n?n(e):s(o,t)})}else if("z-model"===r){e.removeAttribute(r);const i="checkbox"===e.type||"radio"===e.type,c=i?"checked":"value",a=i||"SELECT"===e.tagName?"change":"input";e.addEventListener(a,()=>{let n=e[c];("radio"!==e.type||e.checked)&&t[o]&&(t[o].value=n)}),n(()=>{const n=s(o,t);"radio"===e.type?e.checked=String(e.value)===String(n):e[c]=n})}else if(r.startsWith(":")||r.startsWith("z-")){const i=r.startsWith(":")?r.slice(1):r;r.startsWith(":")&&e.removeAttribute(r),n(()=>{const n=s(o,t);"z-text"===i?e.textContent=n:"z-html"===i?e.innerHTML=n:"z-show"===i?e.style.display=n?"":"none":"style"===i&&"object"==typeof n?Object.assign(e.style,n):"class"===i&&"object"==typeof n?e.className=Object.keys(n).filter(e=>n[e]).join(" "):e.setAttribute(i,n)})}}),e.childNodes.forEach(e=>o(e,t))}}}};function i(e){return{mount(t){const n=document.querySelector(t),r=e();o(n,r)}}}export{i as createApp,r as ref,n as watchEffect};
