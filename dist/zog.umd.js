!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ZogLibrary={})}(this,function(e){"use strict";let t=null;class n{constructor(){this.subs=new Set}depend(){t&&this.subs.add(t)}notify(){this.subs.forEach(e=>e())}}function o(e){const n=t;t=e;try{e()}finally{t=n}}const r=(e,t)=>{try{const n=Object.keys(t),o=n.map(e=>t[e]?._isRef?t[e].value:t[e]);return new Function(...n,`return ${e}`)(...o)}catch{return}},s=(e,t)=>{if(e){if(3===e.nodeType){const n=e.textContent;return void(n.includes("{{")&&o(()=>{e.textContent=n.replace(/{{\s*(.*?)\s*}}/g,(e,n)=>r(n,t))}))}if(1===e.nodeType){if(e.hasAttribute("z-if")){const n=[];let i=e;const c=e.parentNode;if(!c)return;const a=document.createComment("z-if");for(c.insertBefore(a,e);i;){const e=["z-if","z-else-if","z-else"].find(e=>i.hasAttribute(e));if(!e)break;const t=i.getAttribute(e);i.removeAttribute(e),n.push({el:i,exp:t,type:e});const o=i.nextElementSibling;i.remove(),i=o}return void o(()=>{const e=n.find(e=>"z-else"===e.type||r(e.exp,t));n.forEach(n=>{n===e?document.contains(n.el)||(c.insertBefore(n.el,a.nextSibling),n.el._isCompiled||(n.el._isCompiled=!0,s(n.el,t))):document.contains(n.el)&&n.el.remove()})})}if(!e.hasAttribute("z-else-if")&&!e.hasAttribute("z-else")){if(e.hasAttribute("z-for")){const[n,i]=e.getAttribute("z-for").split(" in ").map(e=>e.trim()),c=e.parentNode;if(!c)return;const a=document.createComment("z-for");c.insertBefore(a,e),e.remove(),e.removeAttribute("z-for");let f=[];return void o(()=>{f.forEach(e=>e.remove()),f=[];const o=r(i,t)||[];Array.isArray(o)&&o.forEach((o,r)=>{const i=e.cloneNode(!0);c.insertBefore(i,a),f.push(i);const l={...t,[n]:{value:o,_isRef:!0},index:r};s(i,l)})})}Array.from(e.attributes).forEach(({name:n,value:s})=>{if(n.startsWith("@")||n.startsWith("z-on:")){const o=n.startsWith("@")?n.slice(1):n.slice(5);e.removeAttribute(n),e.addEventListener(o,e=>{const n=t[s];"function"==typeof n?n(e):r(s,t)})}else if("z-model"===n){e.removeAttribute(n);const i="checkbox"===e.type||"radio"===e.type,c=i?"checked":"value",a=i||"SELECT"===e.tagName?"change":"input";e.addEventListener(a,()=>{let n=e[c];("radio"!==e.type||e.checked)&&t[s]&&(t[s].value=n)}),o(()=>{const n=r(s,t);"radio"===e.type?e.checked=String(e.value)===String(n):e[c]=n})}else if(n.startsWith(":")||n.startsWith("z-")){const i=n.startsWith(":")?n.slice(1):n;n.startsWith(":")&&e.removeAttribute(n),o(()=>{const n=r(s,t);"z-text"===i?e.textContent=n:"z-html"===i?e.innerHTML=n:"z-show"===i?e.style.display=n?"":"none":"style"===i&&"object"==typeof n?Object.assign(e.style,n):"class"===i&&"object"==typeof n?e.className=Object.keys(n).filter(e=>n[e]).join(" "):e.setAttribute(i,n)})}}),e.childNodes.forEach(e=>s(e,t))}}}};e.createApp=function(e){return{mount(t){const n=document.querySelector(t),o=e();s(n,o)}}},e.ref=function(e){const t=new n;return{_isRef:!0,get value(){return t.depend(),e},set value(n){n!==e&&(e=n,t.notify())},toString:()=>e}},e.watchEffect=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
